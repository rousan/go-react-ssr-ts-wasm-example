options:
tasks:
  setup:
    run:
      - command: go install github.com/cosmtrek/air@latest
  dev:client:
    run:
      - command: cd client && npm run start && cd ..
  dev:server:
    run:
      - command: cd server && air && cd ..
  dev:
    run:
      - command:
  build:
    run:
      - command: go build -o ./build/neon .
  tidy:
    run:
      - command: go mod tidy
  start:
    run:
      - command: tusk build
      - command: ./build/neon
  up:
    run:
      - command: docker-compose kill
      - command: docker-compose up --no-deps --build
  up:detached:
    run:
      - command: docker-compose kill
      - command: docker-compose up -d --no-deps --build
  deploy:staging:
    run:
      - command: echo "Deploying on the prod server"
      - command: echo "Please update (if any) the .env file for the staging server by logging into the VPS, hit Enter once it's done:" && read confirmation
      - command: ssh root@neon.lab.rousan.io 'bash -s' <./deploy/run-inside-vps.sh staging
  deploy:prod:
    run:
      - command: echo "Deploying on the prod server"
      - command: echo "Please update (if any) the .env file for the prod server by logging into the VPS, hit Enter once it's done:" && read confirmation
      - command: ssh root@neon.lab.rousan.io 'bash -s' <./deploy/run-inside-vps.sh prod
